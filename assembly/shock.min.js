let Q="charCodeAt",J="replaceAll";function r(t,e,l){return c(t,e)?l:c(t[0],o)&&3==t.length&&c(e,t[1])?[o,[...t[1],n],r(t[2],t[1],[...t[1],n])]:t.map(n=>r(n,e,l))}const K=["0"[Q](0),"1"[Q](0)];function B(n){let t=n.length,r=[],e=0;for(;e<t;){if("0"==n.charAt(e)){let l="",c=0,u=n.charAt(++e);for(;e<t&&("1"!=u||c>0);){switch(u[Q](0)){case K[0]:c++;break;case K[1]:c--}l+=u,u=n.charAt(++e)}r.push(B(l))}e++}return r}function l(n){let t=[];for(let r=0;r<n.length;r++){let e=n[r];t.push(l(e))}return"0"+t.join("")+"1"}const n=B("01")[0],o=B("0011")[0],_2=B("001011")[0];function c(n,t){return n?l(n)==l(t):t?0:1}function _E(n){let t=n;if(0==t.length)return n;if(3==t.length){if(c(t[0],o))return[o,t[1],_E(t[2])];if(c(t[0],_2)&&c(t[1][0],o)&&3==t[1].length)return r(t[1][2],t[1][1],t[2])}return n[0]}function evaluate(n){let t=l(_E(B(n)));for(;t.includes("0001011");)t=l(_E(t));return t}