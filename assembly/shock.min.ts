class l {t: l[];constructor(t:l[]){this.t=t};r(v:l,s:l):l{if(c(this,v))return s;else if(c(this.t[0],_1)&&this.t.length==3&&c(v,this.t[1])){this.t[1].t.push(_null);return new l([_1,this.t[1],this.t[2].r(this.t[1],this.t[1])])};let n:l[]=[];for(let i=0;i<this.t.length;i++)n.push(this.t[i].r(v,s));return new l(n)}};const cs=['0'.charCodeAt(0),'1'.charCodeAt(0)];function B(c:string):l{const s=c.length;let t:l=new l([]);let i:i32=0;while(i<s){if(c.charAt(i)=='0'){let d='';let D=0;let C=c.charAt(++i);while(i<s&&(C!='1'||D>0)){switch(C.charCodeAt(0)){case cs[0]:D++;break;case cs[1]:D--;break;default:break};d+=C;C=c.charAt(++i);}t.t.push(B(d))}i++}
return t}export function L(t:l):string{let n:string[]=[];for(let i=0;i<t.t.length;i++)n.push(L(t.t[i]));return `0${n.join('')}1`}const _null=B('01').t[0];const _1=B('0011').t[0];const _2=B('001011').t[0];function c(I:l,R:l):boolean{return L(I)==L(R)}function _e(R:l):l{let T=R.t;if(T.length==0)return R;if(T.length==3){if(c(T[0],_1))return new l([_1,T[1],_e(T[2])]);else if(c(T[0],_2)&&c(T[1].t[0],_1)&&T[1].t.length==3)return T[1].t[2].r(T[1].t[1],T[2])}return R.t[0]}export function evaluate(t:string):string{return L(_e(B(t).t[0]))}